(()=>{var e={};e.id=5413,e.ids=[5413],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},43331:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48900:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>m,serverHooks:()=>g,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{POST:()=>c,dynamic:()=>d});var o=t(54899),a=t(85420),i=t(22403),n=t(44917);let p=require("fs/promises");var u=t(33873),l=t(55511);let d="force-dynamic";async function c(e){try{let r=(await e.formData()).get("file");if(!r)return n.NextResponse.json({error:"No file provided"},{status:400});if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(r.type))return n.NextResponse.json({error:"Invalid file type. Only JPEG, PNG, and WebP are allowed."},{status:400});if(r.size>5242880)return n.NextResponse.json({error:"File too large. Maximum size is 5MB."},{status:400});if(r.size<1024)return n.NextResponse.json({error:"File too small. Please upload a proper image file."},{status:400});let t=Date.now(),s=(0,l.randomBytes)(8).toString("hex"),o=r.name.split(".").pop()||"jpg",a=`${t}-${s}.${o}`,i=await r.arrayBuffer(),d=Buffer.from(i);try{if(d.length<1024)return n.NextResponse.json({error:"Invalid image file. Please upload a proper image."},{status:400})}catch(e){return n.NextResponse.json({error:"Invalid image file format."},{status:400})}let c=(0,u.join)(process.cwd(),"public","uploads","venues"),m=(0,u.join)(c,a);await (0,p.writeFile)(m,d);let x=`/uploads/venues/${a}`;return n.NextResponse.json({success:!0,url:x,filename:r.name,size:r.size,type:r.type,savedAs:a})}catch(e){return console.error("Error uploading file:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"/home/ubuntu/sully-booking-system-production/app/app/api/upload/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:f,serverHooks:g}=m;function v(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:f})}},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67307:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4055,534],()=>t(48900));module.exports=s})();